# ‚ö° –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Webhook

## –ü—Ä–æ–±–ª–µ–º–∞
Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –¥–µ–ø–ª–æ—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ push –≤ GitHub.

## –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ webhook-—Å–µ—Ä–≤–µ—Ä

```bash
ssh user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä
cd /opt/arenda-neba
pm2 list
```

**–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ "webhook" –Ω–µ—Ç:**

```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª webhook-server.js —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la webhook-server.js

# 2. –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã —á–µ—Ä–µ–∑ WinSCP
# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞

# 3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
nano webhook-server.js
# –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É 11 –Ω–∞:
# const PROJECT_DIR = process.env.PROJECT_DIR || '/opt/arenda-neba';

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ PM2
pm2 start webhook-server.js --name webhook
pm2 save
pm2 logs webhook
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ GitHub

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/MassimoUniverse/Arenda-neba-1/settings/hooks
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à webhook (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - **Payload URL**: `http://–í–ê–®_IP:9000/webhook` –∏–ª–∏ `http://–≤–∞—à-–¥–æ–º–µ–Ω.ru:9000/webhook`
   - **Content type**: `application/json`
   - **Events**: Just the push event
   - **Active**: ‚úì

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç 9000
netstat -tulpn | grep 9000

# –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç, –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ
sudo ufw allow 9000/tcp
sudo ufw reload
```

### –®–∞–≥ 4: –¢–µ—Å—Ç

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–º–∏—Ç
cd "F:\New site\deploy"
git commit --allow-empty -m "Test webhook"
git push origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs webhook --lines 20
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üîÑ –ü–æ–ª—É—á–µ–Ω webhook, –∑–∞–ø—É—Å–∫–∞–µ–º –¥–µ–ø–ª–æ–π...
‚úÖ –î–µ–ø–ª–æ–π —É—Å–ø–µ—à–µ–Ω
```

## –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π:
```bash
cd /opt/arenda-neba
git pull origin main
npm install --production
pm2 restart arenda-neba
```

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: —Å–º. `FIX_WEBHOOK.md`
